import unittest
from outpost24hiabclient.entities.target import Target
from outpost24hiabclient.entities.targetgroup import TargetGroup
from outpost24hiabclient.entities.scanner import Scanner
from outpost24hiabclient.clients.hiabclient import HiabClient
from outpost24hiabclient import (Targets, TargetsTreeBuilder)
from unittest.mock import patch

import xml.etree.ElementTree as ET

class HiabClientTest:

    def get_targets(self, targetgroup):
        data=""
        if(targetgroup is None or (targetgroup is not None and targetgroup.xid == -1)):
             data="<RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 13:59\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>11</TOTALCOUNT><COLLAPSEDTOTAL>11</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test1.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1211</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000029</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"2\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test2.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1235</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000055</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"3\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test3.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1216</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000034</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"4\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test4.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1234</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000054</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"5\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><REQUESTBODYBLACKLIST/><HOSTNAME>test5.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><COMPLIANCESENABLED/><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><LASTDISCOVERYDATE>2020-08-03 09:01</LASTDISCOVERYDATE><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS/><LATESTSUCCESSFULSCANDATE>2020-08-03 09:01</LATESTSUCCESSFULSCANDATE><BATCHMODE>false</BATCHMODE><USESLICENSE>true</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1238</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000058</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>0</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><LATESTSCANDATE>2020-08-03 09:01</LATESTSCANDATE><PCI>false</PCI><CUSTOM3/><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2>Team3</CUSTOM2><IGNORECERTS>false</IGNORECERTS><CUSTOM5/><HASDISCOVERYDATA>false</HASDISCOVERYDATA><HIDDENURLS/><CUSTOM0>testinstance2</CUSTOM0><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><URLBLACKLIST/><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"6\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test6.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1224</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000044</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"7\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test7.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1230</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000050</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"8\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><REQUESTBODYBLACKLIST/><HOSTNAME>test8.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><COMPLIANCESENABLED/><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS/><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1267</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000062</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><CUSTOM7/><CUSTOM5/><CUSTOM6/><HASDISCOVERYDATA>false</HASDISCOVERYDATA><HIDDENURLS/><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><URLBLACKLIST/><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"9\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test9.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1265</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000061</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"10\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test10.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1280</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000064</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><CUSTOM9/><PCI>false</PCI><CUSTOM4></CUSTOM4><EXPOSED>false</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><CUSTOM7>westeurope</CUSTOM7><CUSTOM8/><CUSTOM5>Azure</CUSTOM5><CUSTOM6>08fe9a8f-279f-4eb3-bd0a-9ba5cc0e7508</CUSTOM6><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0></CUSTOM0><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"11\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>127.0.0.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS>localhost</VIRTUALHOSTS><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1264</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>0</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><IPADDRESS>127.0.0.1</IPADDRESS><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>true</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
        else:
            if(targetgroup.xid == -2):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 14:06\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>2</TOTALCOUNT><COLLAPSEDTOTAL>2</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test9.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1265</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000061</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"2\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>127.0.0.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS>localhost</VIRTUALHOSTS><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1264</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>0</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><IPADDRESS>127.0.0.1</IPADDRESS><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>true</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            elif(targetgroup.xid == 1035 or targetgroup.xid == 1051):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 14:17\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>6</TOTALCOUNT><COLLAPSEDTOTAL>6</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test1.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1211</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000029</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"2\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test2.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1235</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000055</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"3\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test3.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1216</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000034</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"4\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test4.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1234</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000054</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"5\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test6.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1224</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000044</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"6\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test7.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1230</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000050</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            elif(targetgroup.xid == 1052):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 16:59\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>2</TOTALCOUNT><COLLAPSEDTOTAL>2</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test1.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1211</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000029</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"2\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test3.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1216</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000034</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            elif(targetgroup.xid == 1053):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 17:01\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>4</TOTALCOUNT><COLLAPSEDTOTAL>4</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test2.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1235</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000055</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"2\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test4.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1234</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000054</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"3\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test6.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1224</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000044</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2>LWZ</CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"4\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test7.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1230</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000050</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><EXPOSED>true</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            elif(targetgroup.xid == 1054):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 17:14\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>3</TOTALCOUNT><COLLAPSEDTOTAL>3</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><REQUESTBODYBLACKLIST/><HOSTNAME>test5.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><COMPLIANCESENABLED/><CRAWLED>false</CRAWLED><LOOKUPIPADDRESS>1.1.1.1</LOOKUPIPADDRESS><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><LASTDISCOVERYDATE>2020-08-03 09:01</LASTDISCOVERYDATE><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS/><LATESTSUCCESSFULSCANDATE>2020-08-03 09:01</LATESTSUCCESSFULSCANDATE><BATCHMODE>false</BATCHMODE><USESLICENSE>true</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1238</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000058</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>0</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><LATESTSCANDATE>2020-08-03 09:01</LATESTSCANDATE><PCI>false</PCI><CUSTOM3/><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><CUSTOM5/><HASDISCOVERYDATA>false</HASDISCOVERYDATA><HIDDENURLS/><CUSTOM0></CUSTOM0><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><URLBLACKLIST/><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"2\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><REQUESTBODYBLACKLIST/><HOSTNAME>test8.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><COMPLIANCESENABLED/><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS/><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1267</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000062</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><CUSTOM7/><CUSTOM5/><CUSTOM6/><HASDISCOVERYDATA>false</HASDISCOVERYDATA><HIDDENURLS/><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><URLBLACKLIST/><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET><TARGET rowid=\"3\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test10.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1280</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000064</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><CUSTOM9/><PCI>false</PCI><CUSTOM4></CUSTOM4><EXPOSED>false</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><CUSTOM7>westeurope</CUSTOM7><CUSTOM8/><CUSTOM5></CUSTOM5><CUSTOM6></CUSTOM6><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0></CUSTOM0><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            elif(targetgroup.xid == 1075):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 17:20\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>1</TOTALCOUNT><COLLAPSEDTOTAL>1</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><REQUESTBODYBLACKLIST/><HOSTNAME>test8.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><COMPLIANCESENABLED/><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><VIRTUALHOSTS/><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1267</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000062</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><PCI>false</PCI><CUSTOM4/><EXPOSED>false</EXPOSED><CUSTOM2/><IGNORECERTS>false</IGNORECERTS><CUSTOM7/><CUSTOM5/><CUSTOM6/><HASDISCOVERYDATA>false</HASDISCOVERYDATA><HIDDENURLS/><CUSTOM0/><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><URLBLACKLIST/><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            elif(targetgroup.xid == 1074):
                data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETDATA\" TIMESTAMP=\"2021-02-01 17:22\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><TARGETLIST><TOTALCOUNT>1</TOTALCOUNT><COLLAPSEDTOTAL>1</COLLAPSEDTOTAL><TARGET rowid=\"1\"><TESTCREDXID>0</TESTCREDXID><AUTHENTICATIONTYPE>0</AUTHENTICATIONTYPE><HOSTNAME>test10.local</HOSTNAME><XUPDATOR>0</XUPDATOR><CREDENTIALPROVIDERID>0</CREDENTIALPROVIDERID><SCANNERNAME>Local</SCANNERNAME><MACADDRESS/><ENABLEREMOTEREGISTRY>false</ENABLEREMOTEREGISTRY><CVSS_SR_CONF>ND</CVSS_SR_CONF><UNGROUPED>false</UNGROUPED><MACSOURCE>0</MACSOURCE><CRAWLED>false</CRAWLED><LOW_COUNT>0</LOW_COUNT><REACHABLE>false</REACHABLE><OUTOFSCOPE>false</OUTOFSCOPE><SCANLESS_POSSIBLE>false</SCANLESS_POSSIBLE><CONFIRMED>false</CONFIRMED><BUSINESSCRITICALITY>MEDIUM</BUSINESSCRITICALITY><SCANUPDATEAVAILIBLE>false</SCANUPDATEAVAILIBLE><BATCHMODE>false</BATCHMODE><USESLICENSE>false</USESLICENSE><AUTHENTICATIONRESULT>-1</AUTHENTICATIONRESULT><CYBERARKNTLMV1>false</CYBERARKNTLMV1><MEDIUM_COUNT>0</MEDIUM_COUNT><XID>1280</XID><SCANNERID>0</SCANNERID><LOOKUPPERFORMED>false</LOOKUPPERFORMED><CYBERARKENABLEREMOTEREGISTRY>false</CYBERARKENABLEREMOTEREGISTRY><TEMPLATEOVERRIDE>0</TEMPLATEOVERRIDE><COUNT>0</COUNT><SYNC>0</SYNC><IPERCENTV>0</IPERCENTV><PCICOMPLIANCE>0</PCICOMPLIANCE><HOSTNAMEID>5000000064</HOSTNAMEID><XUSERXID>0</XUSERXID><LATESTSCANSTATUS>-1</LATESTSCANSTATUS><CVSS_SR_AVAIL>ND</CVSS_SR_AVAIL><SMBNTLMV1>false</SMBNTLMV1><PLATFORM>NOTDETECTED</PLATFORM><CUSTOM9/><PCI>false</PCI><CUSTOM4></CUSTOM4><EXPOSED>false</EXPOSED><CUSTOM2></CUSTOM2><IGNORECERTS>false</IGNORECERTS><CUSTOM7></CUSTOM7><CUSTOM8/><CUSTOM5>Azure</CUSTOM5><CUSTOM6></CUSTOM6><HASDISCOVERYDATA>false</HASDISCOVERYDATA><CUSTOM0></CUSTOM0><CVSS_SR_INTEG>ND</CVSS_SR_INTEG><CVSS_CDP>ND</CVSS_CDP><CVSS_TD>ND</CVSS_TD><COMPLIANT>0</COMPLIANT><HIGH_COUNT>0</HIGH_COUNT></TARGET></TARGETLIST></RESPONSE>"
            else:
                data=""

        xmldata = ET.fromstring(data)
        targetlist = xmldata.findall('TARGETLIST')
        if(len(targetlist) >= 1):
            targets = targetlist[0].findall('TARGET')
            return [Target(self,t) for t in targets]
        return []

    def get_targetgroups(self):
        data="<?xml version=\"1.0\" encoding=\"UTF-8\"?><RESPONSE ACTION=\"TARGETGROUPDATA\" TIMESTAMP=\"2021-02-01 17:38\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\"><GROUPLIST><TOTALCOUNT>9</TOTALCOUNT><COLLAPSEDTOTAL>9</COLLAPSEDTOTAL><GROUP rowid=\"1\"><RULEBASED>false</RULEBASED><DESCRIPTION/><RULE/><REPORTBASED>false</REPORTBASED><XID>-1</XID><ICOUNT>11</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>All targets</NAME><XIPARENTID>-3</XIPARENTID></GROUP><GROUP rowid=\"2\"><RULEBASED>false</RULEBASED><DESCRIPTION/><RULE/><REPORTBASED>false</REPORTBASED><XID>-2</XID><ICOUNT>2</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>Ungrouped</NAME><XIPARENTID>-1</XIPARENTID></GROUP><GROUP rowid=\"3\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1051</XID><ICOUNT>6</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup1</NAME><XIPARENTID>1035</XIPARENTID></GROUP><GROUP rowid=\"4\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1035</XID><ICOUNT>6</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup2</NAME><XIPARENTID>-1</XIPARENTID></GROUP><GROUP rowid=\"5\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1075</XID><ICOUNT>1</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup3</NAME><XIPARENTID>1054</XIPARENTID></GROUP><GROUP rowid=\"6\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1054</XID><ICOUNT>3</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup4</NAME><XIPARENTID>-1</XIPARENTID></GROUP><GROUP rowid=\"7\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1074</XID><ICOUNT>1</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup5</NAME><XIPARENTID>1054</XIPARENTID></GROUP><GROUP rowid=\"8\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1052</XID><ICOUNT>2</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup6</NAME><XIPARENTID>1051</XIPARENTID></GROUP><GROUP rowid=\"9\"><RULEBASED>false</RULEBASED><RULE/><REPORTBASED>false</REPORTBASED><XID>1053</XID><ICOUNT>4</ICOUNT><PCI>false</PCI><XUSERXID>11</XUSERXID><NAME>targetgroup7</NAME><XIPARENTID>1051</XIPARENTID></GROUP></GROUPLIST></RESPONSE>"
        xmldata = ET.fromstring(data)
        grouplist = xmldata.findall('GROUPLIST')
        if(len(grouplist) >= 1):
            groups = grouplist[0].findall('GROUP')
            return [TargetGroup(self,g) for g in groups]
        return []

    def create_targetgroup(self, child_targetgroup_name, parent_targetgroup):
        pass

    def create_targets(self, targetaddresses, targetgroup, dnslookup, scanner):
        pass

    def move_target(self, target, src_targetgroup, dst_targetgroup, dst_parent_targetgroup):
        pass

    def update_target(self, target, scannerid, virtualhosts, custom0, custom1, custom2, custom3, custom4, custom5, custom6, custom7, custom8, custom9):
        pass

    def delete_targets(self, targets):
        pass

    def get_scanners(self):
        data="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\
                <RESPONSE ACTION=\"SCANNERDATA\" TIMESTAMP=\"2021-01-28 11:54\" USERNAME=\"ACCEPTANCE\" VERSION=\"4.22.12.0\">\
	                <SCANNERLIST>\
		                <TOTALCOUNT>2</TOTALCOUNT>\
		                <COLLAPSEDTOTAL>2</COLLAPSEDTOTAL>\
		                <SCANNER rowid=\"1\">\
			                <IPADDRESS>127.0.0.1</IPADDRESS>\
			                <ISAWSSCANNER>false</ISAWSSCANNER>\
			                <USEPROXY>false</USEPROXY>\
			                <POLLING>false</POLLING>\
			                <ISOUTPOST>false</ISOUTPOST>\
			                <MODE>1</MODE>\
			                <APPSECSCALESCANNER>false</APPSECSCALESCANNER>\
			                <XID>0</XID>\
			                <APPROVED>true</APPROVED>\
			                <INACTIVE>false</INACTIVE>\
			                <XUPDATOR>0</XUPDATOR>\
			                <PERFORMUPDATE>false</PERFORMUPDATE>\
			                <ISGROUP>false</ISGROUP>\
			                <XUSERXID>11</XUSERXID>\
			                <NAME>Local</NAME>\
			                <SCANNINGDISABLED>false</SCANNINGDISABLED>\
			                <SLSSCANSCHEDULED>false</SLSSCANSCHEDULED>\
		                </SCANNER>\
		                <SCANNER rowid=\"2\">\
			                <IPADDRESS>outscan.outpost24.com</IPADDRESS>\
			                <ISAWSSCANNER>false</ISAWSSCANNER>\
			                <USEPROXY>false</USEPROXY>\
			                <POLLING>false</POLLING>\
			                <ISOUTPOST>true</ISOUTPOST>\
			                <MODE>1</MODE>\
			                <APPSECSCALESCANNER>false</APPSECSCALESCANNER>\
			                <XID>2</XID>\
			                <APPROVED>false</APPROVED>\
			                <INACTIVE>false</INACTIVE>\
			                <XUPDATOR>0</XUPDATOR>\
			                <PERFORMUPDATE>false</PERFORMUPDATE>\
			                <ISGROUP>false</ISGROUP>\
			                <XUSERXID>11</XUSERXID>\
			                <NAME>Outscan</NAME>\
			                <SCANNINGDISABLED>false</SCANNINGDISABLED>\
			                <SLSSCANSCHEDULED>false</SLSSCANSCHEDULED>\
		                </SCANNER>\
	                </SCANNERLIST>\
	                <PROXYENABLED>0</PROXYENABLED>\
	                <NOTIFYMISSING>0</NOTIFYMISSING>\
                </RESPONSE>"
        xmldata = ET.fromstring(data)
        scannerlist = xmldata.findall('SCANNERLIST')
        if(len(scannerlist) >= 1):
            scanners = scannerlist[0].findall('SCANNER')
            return [Scanner(self,s) for s in scanners]


class TargetServiceTests(unittest.TestCase):

    @patch.object(HiabClient, '__init__', lambda x, y, z: None)
    def setUp(self):
        service = Targets("url", "token")
        # now we mock the HiabClient within the service class
        service._hiabclient = HiabClientTest()
        self.target_service = service

    def test_get_targets_tree(self):
        targets_tree = self.target_service.get_targets_tree()
        root_node = targets_tree.get_root_node()
        fq_string = root_node.get_fq_string()

        self.assertTrue(targets_tree is not None)
        self.assertTrue(root_node is not None)
        self.assertEqual(fq_string, "\\All targets")

    def test_get_target_nodes(self):
        target_nodes = self.target_service.get_target_nodes()
        self.assertEqual(len(target_nodes), 11)

    def test_get_targetgroup_nodes(self):
        targetgroup_nodes = self.target_service.get_targetgroup_nodes()
        self.assertEqual(len(targetgroup_nodes), 8)

    def test_create_targetgroup_node_from_fq_string(self):
        testgroup1_targetgroup_node = self.target_service.create_targetgroup_node_from_fq_string("\\All targets\\testgroup1")
        root = testgroup1_targetgroup_node.get_parent()
        self.assertIsNotNone(testgroup1_targetgroup_node)
        self.assertIsNotNone(root)


class TargetTreeTests(unittest.TestCase):

    @patch.object(HiabClient, '__init__', lambda x, y, z: None)
    def setUp(self):
        service = Targets("url", "token")
        # now we mock the HiabClient within the service class
        service._hiabclient = HiabClientTest()
        self.target_service = service
        self.targets_tree = self.target_service.get_targets_tree()


    def test_get_target_nodes_in_targetgroup(self):
        targetgroup_node = self.targets_tree.get_targetgroup_node_from_fq_string("\\All targets\\targetgroup2\\targetgroup1")
        target_nodes = targetgroup_node.get_target_nodes()
        self.assertEqual(len(target_nodes), 6)

    def test_get_parent_targetgroup_of_target(self):
        scanner = self.target_service.get_scanner_by_name("Local")
        target_node = self.targets_tree.get_target_node(ipaddress="1.1.1.1", hostname="test3.local", scanner=scanner)
        targetgroup_node = target_node.get_parent_targetgroup_node()

        self.assertIsNotNone(target_node)
        self.assertIsNotNone(targetgroup_node)
        self.assertEqual(targetgroup_node.get_targetgroup().name, "targetgroup1")

    def test_get_parent_targetgroup_of_targetgroup(self):
        targetgroup_node = self.targets_tree.get_targetgroup_node_from_fq_string("\\All targets\\targetgroup2\\targetgroup1")
        parent_targetgroup_node = targetgroup_node.get_parent()

        self.assertIsNotNone(parent_targetgroup_node)
        self.assertEqual(parent_targetgroup_node.get_targetgroup().name, "targetgroup2")


    def test_get_child_targetgroup_of_targetgroup(self):
        targetgroup_node = self.targets_tree.get_targetgroup_node_from_fq_string("\\All targets\\targetgroup2")
        child = targetgroup_node.get_child_with_name("targetgroup1")
        self.assertIsNotNone(child)
        self.assertEqual(child.get_targetgroup().name, "targetgroup1")


    def test_get_targetgroup_node_from_string(self):
        targetgroup_node = self.targets_tree.get_targetgroup_node_from_fq_string("\\All targets\\targetgroup2\\targetgroup1")
        self.assertIsNotNone(targetgroup_node)
        self.assertEqual(targetgroup_node.get_targetgroup().name, "targetgroup1")

